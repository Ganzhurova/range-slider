!function(){"use strict";!function(){var t,e={isDouble:!1,isVertical:!1,isLabel:!1,isScale:!1,min:0,max:100,scaleParts:4,from:25,to:75,step:0};!function(t){t.NEW_STATE="newState",t.NEW_PERCENT_POSITION="newPercentPosition",t.NEW_POSITION="newPosition",t.VERTICAL_CHANGED="isVerticalChanged",t.DOUBLE_CHANGED="isDoubleChanged",t.LABEL_CHANGED="isLabelChanged",t.SCALE_CHANGED="isScaleChanged",t.THUMB_SELECTED="thumbSelected"}(t||(t={}));const i={LEFT:{name:"left",size:"width",coord:"x"},TOP:{name:"top",size:"height",coord:"y"}};var s=class{constructor(){var t,e,i;i=void 0,(e="events")in(t=this)?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,this.events={}}subscribe(t,e){(this.events[t]||(this.events[t]=[])).push(e)}unsubscribe(t,e){this.events[t]&&(this.events[t]=this.events[t].filter((t=>e!==t)))}emit(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];(this.events[t]||[]).forEach((t=>t(...i)))}};function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function n(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var a=class extends s{constructor(){super(...arguments),r(this,"state",n({},e))}updateState(e){const i=n({},this.getState());Object.assign(this.state,e),this.validate();const s=this.getChangedKeys(i);s.length>0&&this.emit(t.NEW_STATE,s)}getState(){return this.state}getChangedKeys(t){const e=[];return Object.keys(t).forEach((i=>{t[i]!==this.state[i]&&e.push(i)})),e}validate(){this.validateLimits(),this.validatePos(),this.validateStep(),this.validateScaleParts()}validateLimits(){let{min:t,max:e}=this.state;t===e&&(e+=1),t>e&&([t,e]=[e,t]),this.state.min=t,this.state.max=e}validatePos(){let{from:t,to:e}=this.state;const i=t=>t>=this.state.min&&t<=this.state.max,s=()=>this.state.min,o=()=>this.state.max;i(t)||(t=s()),i(e)||(e=o()),(()=>this.state.isDouble&&t>e)()&&([t,e]=[e,t]),this.state.from=t,this.state.to=e}validateStep(){const{step:t}=this.state;this.state.step=Math.abs(t)}validateScaleParts(){let t=this.state.scaleParts;t=Number.isInteger(t)?t:Math.round(t),this.state.scaleParts=Math.abs(t)}};const h="range-slider",l={rootEl:{tag:"div",className:h},line:{tag:"div",className:`${h}__line`},bar:{tag:"div",className:`${h}__bar`},thumb:{tag:"div",className:`${h}__thumb`},label:{tag:"div",className:`${h}__label`},scale:{tag:"div",className:`${h}__scale`},scalePoint:{tag:"span",className:`${h}__point`},scaleValue:{tag:"span",className:`${h}__value`}},c="vertical",d="selected";function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var m=class extends s{constructor(t,e,i){super(),u(this,"data",void 0),u(this,"options",void 0),u(this,"el",void 0),u(this,"isElExists",!1),this.data=e.data,this.options=e.options,this.init(t,i)}init(t,e){this.el=e||document.createElement(t.tag),this.addClass(t.className)}addClass(t){this.el.classList.add(t)}removeClass(t){this.el.classList.remove(t)}addChild(t){const e=t;this.el.append(e.getEl()),e.isElExists=!0}remove(){this.el.remove(),this.isElExists=!1}hidden(){this.el.style.visibility="hidden"}show(){this.el.style.visibility=""}getEl(){return this.el}getBox(){return this.el.getBoundingClientRect()}getSize(){return this.getBox()[this.data.direction.size]}getCoord(){const t=this.getBox(),e="x"===this.data.direction.coord?window.pageXOffset:window.pageYOffset;return t[this.data.direction.name]+e}positionToPercent(t){return t*this.data.percentPerPosition}percentToPosition(t){return t/this.data.percentPerPosition}percentToPx(t){return t/this.data.percentPerPx}pxToPercent(t){return t*this.data.percentPerPx}static checkOverlay(t,e){return t.getCoord()+t.getSize()>=e.getCoord()}};var b=class extends m{setDirection(t){this.el.classList.toggle(c,t)}clear(){this.el.innerHTML="",this.removeClass(l.rootEl.className),this.el.classList.contains(c)&&this.removeClass(c)}};var v=class extends m{constructor(){var t,e,i;super(...arguments),i=void 0,(e="correctValue")in(t=this)?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}setup(t){this.correctValue=this.pxToPercent(t/2)}update(t,e){const i=this.options.isDouble?t+this.correctValue:0,s=this.options.isDouble?e-t:t+this.correctValue;this.el.setAttribute("style",`${this.data.direction.name}:${i}%; ${this.data.direction.size}:${s}%`)}};function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var P=class extends s{constructor(t){super(),p(this,"view",void 0),p(this,"options",void 0),this.view=t,this.options=t.options,this.init(),this.subscribeToEvents()}init(){this.view.line.addChild(this.view.bar),this.view.line.addChild(this.view.fromThumb),this.view.root.addChild(this.view.line)}setDirection(t){this.view.data.direction=t?i.TOP:i.LEFT,this.view.root.setDirection(t)}setType(t){t?this.view.line.addChild(this.view.toThumb):this.view.toThumb.remove()}setLabel(t){t?(this.view.line.addChild(this.view.fromLabel),this.view.toThumb.isElExists?(this.view.line.addChild(this.view.commonLabel),this.view.line.addChild(this.view.toLabel)):(this.view.commonLabel.remove(),this.view.toLabel.remove())):(this.view.fromLabel.remove(),this.view.toLabel.remove())}setScale(t){t?this.view.root.addChild(this.view.scale):this.view.scale.remove()}subscribeToEvents(){this.subscribe(t.VERTICAL_CHANGED,(()=>{this.setDirection(this.options.isVertical)})),this.subscribe(t.DOUBLE_CHANGED,(()=>{this.setType(this.options.isDouble),this.setLabel(this.options.isLabel)})),this.subscribe(t.LABEL_CHANGED,(()=>{this.setLabel(this.options.isLabel)})),this.subscribe(t.SCALE_CHANGED,(()=>{this.setScale(this.options.isScale)}))}update(t){t.forEach((t=>{this.emit(`${t}Changed`)}))}};var g=class extends m{};function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var E=class{constructor(t){f(this,"view",void 0),f(this,"data",void 0),f(this,"options",void 0),this.view=t,this.data=t.data,this.options=t.options}convertLinePxToPercent(){this.data.percentPerPx=100/this.view.line.getSize()}calcLimitSizeOfLine(){this.data.percentageLimitSize=(this.view.line.getSize()-this.view.fromThumb.getSize())*this.data.percentPerPx}calcPercentPerPosition(){const{min:t,max:e}=this.options,i=Math.abs(e-t);this.data.percentPerPosition=this.data.percentageLimitSize/i}calcFractionLength(){const t=[],{min:e,max:i,from:s,step:o}=this.options;if(t.push(e,i,s,o),this.options.isDouble){const{to:e}=this.options;t.push(e)}const n=t.map((t=>{var e;return t.toString().includes(".")?null===(e=t.toString().split(".").pop())||void 0===e?void 0:e.length:0}));this.data.fractionLength=Math.max(...n)}makeBaseCalc(){this.convertLinePxToPercent(),this.calcLimitSizeOfLine(),this.calcPercentPerPosition(),this.calcFractionLength()}getLimitCoords(t){const e=this.view.fromThumb.getPercentPosition(),i=this.view.toThumb.getPercentPosition(),s=this.data.percentageLimitSize;return{start:"from"===t?0:e,end:"from"===t?(()=>this.options.isDouble?i:s)():s}}};var T={getEventCoord(t,e){const i=`page${e}`;return(-1!==t.type.search("touch")?t.touches[0]:t)[i]},getClosestValue:(t,e)=>t.reduce(((t,i)=>Math.abs(i-e)<Math.abs(t-e)?i:t))};function C(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var L=class extends m{constructor(e,i){super(e,i),C(this,"percentPosition",0),C(this,"limitCoords",void 0),this.subscribe(t.THUMB_SELECTED,(t=>{t===this.el?this.addClass(d):this.removeClass(d)}))}setLimitCoords(t){this.limitCoords=t}calcPercentPositionWithStep(t){const e=this.positionToPercent(this.options.step);return e?Math.round(t/e)*e:t}getValidPercentCoord(t){return t<this.limitCoords.start?this.limitCoords.start:t>this.limitCoords.end?this.limitCoords.end:t}setPercentPosition(t){this.percentPosition=t}getPercentPosition(){return this.percentPosition}getPosition(){return+(t=>t+this.options.min)(this.percentToPosition(this.getPercentPosition())).toFixed(this.data.fractionLength)}setup(t){if(!this.isElExists)return;const e=this.options[t];this.setPercentPosition(this.positionToPercent((t=>t-this.options.min)(e)))}update(){this.isElExists&&this.el.setAttribute("style",`${this.data.direction.name}:${this.percentPosition}%`)}handlerThumbDragStart(e,i){const s=e.target.closest(`.${l.thumb.className}`);if(s&&this.emit(t.THUMB_SELECTED,s),s!==this.el)return;e.preventDefault(),this.setLimitCoords(i);const o=T.getEventCoord(e,this.data.direction.coord.toUpperCase())-this.getCoord(),n=this.handlerThumbDrag.bind(this,o),r=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",r),document.removeEventListener("touchmove",n),document.removeEventListener("touchend",r)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",r),document.addEventListener("touchmove",n),document.addEventListener("touchend",r)}handlerThumbDrag(e,i){const s=T.getEventCoord(i,this.data.direction.coord.toUpperCase())-e,o=this.pxToPercent(this.getCoord()-s),n=this.getPercentPosition()-o,r=this.getValidPercentCoord(this.calcPercentPositionWithStep(n));this.setPercentPosition(r),this.emit(t.NEW_PERCENT_POSITION),this.update()}};function w(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class S extends m{constructor(){super(...arguments),w(this,"thumbSizePercent",void 0),w(this,"percentPosition",void 0),w(this,"text",void 0)}setPercentPosition(t){const e=(this.pxToPercent(this.getSize())-this.thumbSizePercent)/2;this.percentPosition=t-e}getPercentPosition(){return this.percentPosition}setText(t){this.text=t}getText(){return this.text}setup(t){this.isElExists&&(this.thumbSizePercent=this.pxToPercent(t))}update(t,e){this.isElExists&&(this.setText(e),this.el.innerHTML=this.text,this.setPercentPosition(t),this.el.setAttribute("style",`${this.data.direction.name}:${this.percentPosition}%`))}static switchCommonLabel(t,e,i){if(!i.isElExists)return void e.show();S.checkOverlay(e,i)?(t.setup(0),t.update((()=>{const t=e.getPercentPosition()+e.pxToPercent(e.getSize());return(i.getPercentPosition()-t)/2+t})(),(()=>{const t=e.getText(),s=i.getText();return t!==s?`${t} &ndash; ${s}`:t})()),e.hidden(),i.hidden(),t.show()):(e.show(),i.show(),t.hidden())}}var O=S;function x(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class y extends m{constructor(){super(...arguments),x(this,"values",[]),x(this,"points",[])}getScaleValues(){const t=[],{min:e,max:i,scaleParts:s}=this.options,o=(i-e)/s;let n=e;for(let e=0;e<=s;e+=1)t.push(n.toFixed(this.data.fractionLength)),n=+n+o;return t}createComponent(t,e){const i={data:this.data,options:this.options},s=new m(t,i);return e&&(s.getEl().textContent=e),s}renderComponent(t,e,i,s){const o=this.createComponent(t,s);o.getEl().setAttribute("style",`${this.data.direction.name}:${e}%; transform: translate${this.data.direction.coord.toUpperCase()}(-50%)`),this.addChild(o),i.push(o)}setVisibilityOfValues(){let t=0,e=1;const i=t=>{this.values[t].hidden(),this.points[t].hidden()},s=t=>{this.values[t].show(),this.points[t].show()};for(let o=t;o<this.values.length-1;o+=1){if(y.checkOverlay(this.values[t],this.values[e]))if(e===this.values.length-1){const s=this.values[t],o=this.values[e],n=s.getCoord()+s.getSize()-o.getCoord();if((()=>n<s.getSize()/3)()){const t=-50+100*n/o.getSize();o.getEl().style.transform=`translate${this.data.direction.coord.toUpperCase()}(${t}%)`}else i(t)}else i(e),e+=1;else s(e),t=e,e+=1}}renderDivisions(){if(!this.isElExists)return;this.el.innerHTML="",this.values=[],this.points=[];const t=this.getScaleValues(),e=100/(t.length-1);t.forEach(((t,i)=>{this.renderComponent(l.scalePoint,e*i,this.points),this.renderComponent(l.scaleValue,e*i,this.values,t)}))}setup(){this.isElExists&&(this.el.setAttribute("style",`${this.data.direction.size}:${this.data.percentageLimitSize}%`),this.setVisibilityOfValues())}handlerScaleValueClick(e){const i=e.target;if(!i.closest(`.${l.scaleValue.className}`))return;e.preventDefault();const s=this.values.findIndex((t=>t.getEl()===i)),o=this.data.percentageLimitSize/this.options.scaleParts*s;this.emit(t.NEW_PERCENT_POSITION,o)}}var N=y;function D(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var _=class extends s{constructor(t,e){super(),D(this,"el",void 0),D(this,"template",void 0),D(this,"calculation",void 0),D(this,"options",void 0),D(this,"data",{direction:i.LEFT,percentPerPx:0,percentPerPosition:0,percentageLimitSize:0,fractionLength:0}),D(this,"root",void 0),D(this,"line",void 0),D(this,"bar",void 0),D(this,"fromThumb",void 0),D(this,"toThumb",void 0),D(this,"fromLabel",void 0),D(this,"toLabel",void 0),D(this,"commonLabel",void 0),D(this,"scale",void 0),this.el=t,this.options=e;const s={data:this.data,options:this.options};this.root=new b(l.rootEl,s,t),this.line=new g(l.line,s),this.bar=new v(l.bar,s),this.fromThumb=new L(l.thumb,s),this.toThumb=new L(l.thumb,s),this.fromLabel=new O(l.label,s),this.toLabel=new O(l.label,s),this.commonLabel=new O(l.label,s),this.scale=new N(l.scale,s),this.template=new P(this),this.calculation=new E(this),this.subscribeToThumbEvent("from"),this.subscribeToThumbEvent("to"),this.subscribeToScaleEvent(),this.addEventListeners(),this.setup()}updatePosition(t,e){this.options[e]=t}subscribeToThumbEvent(e){const i=this[`${e}Thumb`];i.subscribe(t.NEW_PERCENT_POSITION,(()=>{this.updatePosition(i.getPosition(),e),this.updateThumbPosition(e),this.emit(t.NEW_POSITION)}))}subscribeToScaleEvent(){this.scale.subscribe(t.NEW_PERCENT_POSITION,(e=>{let i=this.fromThumb;if(this.options.isDouble){const t=this.fromThumb.getPercentPosition(),s=this.toThumb.getPercentPosition();if(e>s)i=this.toThumb;else{const o=T.getClosestValue([t,s],e);i=[this.fromThumb,this.toThumb].find((t=>t.getPercentPosition()===o))}}i.setPercentPosition(e),i.emit(t.NEW_PERCENT_POSITION)}))}handlerUpdateOnResize(){this.setup()}handlerThumbDragStart(t){this.fromThumb.handlerThumbDragStart(t,this.calculation.getLimitCoords("from")),this.toThumb.handlerThumbDragStart(t,this.calculation.getLimitCoords("to"))}handlerScaleValueClick(t){this.scale.handlerScaleValueClick(t)}addEventListeners(){this.handlerUpdateOnResize=this.handlerUpdateOnResize.bind(this),this.handlerThumbDragStart=this.handlerThumbDragStart.bind(this),this.handlerScaleValueClick=this.handlerScaleValueClick.bind(this),window.addEventListener("resize",this.handlerUpdateOnResize),this.el.addEventListener("mousedown",this.handlerThumbDragStart),this.el.addEventListener("touchstart",this.handlerThumbDragStart),this.el.addEventListener("click",this.handlerScaleValueClick),this.el.addEventListener("touchstart",this.handlerScaleValueClick)}removeEventListeners(){window.removeEventListener("resize",this.handlerUpdateOnResize),this.el.removeEventListener("mousedown",this.handlerThumbDragStart),this.el.removeEventListener("touchstart",this.handlerThumbDragStart),this.el.removeEventListener("click",this.handlerScaleValueClick),this.el.removeEventListener("touchstart",this.handlerScaleValueClick)}getPositionText(t){return this.options[t].toFixed(this.data.fractionLength)}updateThumbPosition(t){const e=this[`${t}Thumb`],i=this[`${t}Label`];e.update(),i.update(e.getPercentPosition(),this.getPositionText(t)),O.switchCommonLabel(this.commonLabel,this.fromLabel,this.toLabel),this.bar.update(this.fromThumb.getPercentPosition(),this.toThumb.getPercentPosition())}setup(){this.calculation.makeBaseCalc(),this.fromThumb.setup("from"),this.toThumb.setup("to"),this.fromLabel.setup(this.fromThumb.getSize()),this.toLabel.setup(this.fromThumb.getSize()),this.bar.setup(this.fromThumb.getSize()),this.scale.renderDivisions(),this.scale.setup(),this.updateThumbPosition("from"),this.updateThumbPosition("to")}update(t){this.template.update(t),this.setup()}destroy(){this.root.clear(),this.removeEventListeners()}};const z=["onStart","onChange"];function V(t,e){if(null==t)return{};var i,s,o=function(t,e){if(null==t)return{};var i,s,o={},n=Object.keys(t);for(s=0;s<n.length;s++)i=n[s],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(s=0;s<n.length;s++)i=n[s],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function $(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var j,A=class{constructor(t,e){$(this,"model",void 0),$(this,"view",void 0),$(this,"options",{}),this.model=new a,this.view=new _(t,this.model.getState()),this.init(),this.update(e)}init(){this.model.subscribe(t.NEW_STATE,(t=>this.view.update(t))),this.view.subscribe(t.NEW_POSITION,(()=>{this.callCallback("onChange")}))}callCallback(t){var e,i;this.options[t]&&(null===(e=(i=this.options)[t])||void 0===e||e.call(i,this.model.getState()))}update(t){if(!t)return;Object.assign(this.options,t);this.model.updateState((t=>{let{onStart:e,onChange:i}=t;return V(t,z)})(t)),this.callCallback("onStart")}destroy(){this.view.destroy()}};(j=jQuery).fn.rangeSlider=function(t){const e="rangeSlider";return this.each((function(){j.data(this,e)||j.data(this,e,new A(this,t))}))}}()}();